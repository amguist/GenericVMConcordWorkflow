configuration:
  dependencies:

  arguments:
    concordPid: ${txId}
    concordServerUrl: "http://localhost:8001/#/process"

  meta:
    artifactId: ""
    version: ""
    completedStage: ""
    deployToAllNodes: false

flows:
  default:
    - log: "Process ID is ${concordPid}"
    - form: deploymentForm
    - set:
        groupId: ${deploymentForm.groupId}
        artifactId: ${deploymentForm.artifactId}
        version: ${deploymentForm.version}
        environment: ${deploymentForm.environment}
        deployToAllNodes: ${deploymentForm:deployToAllNodes}
    - switch: ${environment}
      Development:
        - if: ${deployToAllNodes}
          then:
            - log: "************************************************************************************************"
            - log: "** Initiating Deployment Prerequisites to deploy to [ ${environment} ] for all defined nodes ** "
            - log: "************************************************************************************************"
          else:
            - form: developmentForm
      default:
        - log: "Environment will be: ${environment}"

  targetDeployment:
    - log: "You are here"

forms:
  deploymentForm:
    - groupId: { label: "Group Identifier", type: "string", placeholder: "Input Artifact Group Identifier"}
    - artifactId: { label: "Artifact Identifier", type: "string", placeholder: "Input Artifact Group Identifier"}
    - version: { label: "Artifact Version", type: "string", placeholder: "Input Artifact Version"}
    - environment: { label: "Environment", type: "string", placeholder: "Select Environment Type", allow: ["Development","QA","Stage","Performance","Production"]}
    - deployToAllNodes: { label: "Deploy To All Nodes For Given Environment", type: "boolean", default: false }

  developmentForm:
    - businessUnit: { label: "Business Unit", type: "string", placeholder: "Select Business Unit", allow: ["32818"]}
    - serverAddress: { label: "Server Address", type: "string", placeholder: "Select Server Address", allow: ["us32818s4000d0a.s32818.us.wal-mart.com"]}

